# Geo Social Map

React-приложение на TypeScript для отображения интерактивной карты с пользователями и поиском по геолокации и интересам.

## Описание

Приложение отображает пользователей на интерактивной карте с использованием Leaflet.js. Каждый пользователь представлен маркером на карте, при клике на который отображается информация о пользователе и его интересах. При отдалении карты маркеры автоматически группируются в кластеры для улучшения производительности и читаемости.

## Технологии

- **React 19** - библиотека для создания пользовательских интерфейсов
- **TypeScript** - типизированный JavaScript
- **Vite** - сборщик и dev-сервер
- **Leaflet.js** - библиотека для работы с картами
- **react-leaflet** - React-обёртка для Leaflet
- **react-leaflet-cluster** - кластеризация маркеров
- **Tailwind CSS v4** - утилитарный CSS-фреймворк

## Структура проекта

```
src/
├── components/
│   ├── MapView.tsx       # Основной компонент карты с кластеризацией
│   ├── UserMarker.tsx    # Компонент маркера пользователя с popup
│   └── Filters.tsx       # Компонент фильтрации по интересам
├── types.ts              # TypeScript типы
├── App.tsx               # Главный компонент приложения
├── main.tsx              # Точка входа
└── index.css             # Глобальные стили и Tailwind CSS

public/
└── users.json            # Моковые данные пользователей (10 пользователей)
```

## Компоненты

### App.tsx

Главный компонент приложения, который:
- Загружает данные пользователей из `users.json` через HTTP-запрос
- Управляет состоянием фильтрации по интересам
- Отображает компоненты `Filters` и `MapView`
- Показывает состояние загрузки

**Состояния:**
- `users` - массив всех пользователей
- `interestFilter` - текущее значение фильтра
- `loading` - состояние загрузки данных

### MapView.tsx

Компонент карты, который:
- Отображает интерактивную карту OpenStreetMap
- Применяет фильтрацию пользователей по интересам через `useMemo`
- Автоматически вычисляет центр карты на основе отфильтрованных пользователей
- Использует `MarkerClusterGroup` для кластеризации маркеров
- Настраивает иконки маркеров Leaflet

**Пропсы:**
- `users: User[]` - массив пользователей
- `interestFilter: string` - строка фильтрации

**Особенности:**
- Фильтрация оптимизирована через `useMemo` для предотвращения лишних пересчётов
- Центр карты автоматически пересчитывается при изменении фильтра
- Кластеры автоматически обновляются при фильтрации

### UserMarker.tsx

Компонент маркера пользователя, который:
- Отображает маркер на карте по координатам пользователя
- Показывает popup с именем пользователя и списком интересов
- Использует теги для отображения интересов

**Пропсы:**
- `user: User` - объект пользователя

### Filters.tsx

Компонент фильтрации, который:
- Предоставляет input для ввода текста фильтра
- Передаёт изменения фильтра в родительский компонент через callback
- Имеет адаптивный дизайн с Tailwind CSS

**Пропсы:**
- `onFilterChange: (filter: string) => void` - callback для изменения фильтра

## Типы данных

### User

```typescript
interface User {
  id: string;
  name: string;
  lat: number;
  lon: number;
  interests: string[];
}
```

## Данные пользователей

Данные хранятся в файле `public/users.json` и содержат 10 пользователей с координатами в районе Москвы (широта ~55.75, долгота ~37.61).

**Интересы пользователей:**
- music
- travel
- photography
- reading
- cooking
- sports

## Функциональность

### Отображение карты

- Карта использует бесплатные тайлы OpenStreetMap
- Адаптивный дизайн, занимает весь экран
- Начальный центр карты: Москва (55.7558, 37.6173)
- Начальный уровень масштабирования: 13

### Кластеризация маркеров

- При отдалении карты маркеры автоматически группируются в кластеры
- Кластеры показывают количество пользователей внутри
- При клике на кластер карта плавно приближается к этой области
- При максимальном приближении кластеры раскрываются в отдельные маркеры

### Фильтрация по интересам

- Input для ввода текста фильтра расположен над картой по центру
- Фильтрация происходит в реальном времени при вводе текста
- Поиск не чувствителен к регистру
- Фильтрация работает по частичному совпадению (includes)
- Если у пользователя хотя бы один интерес содержит введённый текст, он отображается
- Кластеры автоматически пересчитываются после фильтрации
- Центр карты автоматически пересчитывается на основе отфильтрованных пользователей

### Popup пользователя

- При клике на маркер открывается popup
- Popup содержит:
  - Имя пользователя (жирным шрифтом)
  - Список интересов в виде цветных тегов

## Установка и запуск

### Установка зависимостей

```bash
npm install
```

### Запуск dev-сервера

```bash
npm run dev
```

Приложение будет доступно по адресу `http://localhost:5173` (или другому порту, указанному Vite).

### Сборка для production

```bash
npm run build
```

### Просмотр production сборки

```bash
npm run preview
```

## Оптимизация

1. **useMemo для фильтрации** - предотвращает лишние пересчёты при каждом рендере
2. **useMemo для центра карты** - пересчитывается только при изменении отфильтрованных пользователей
3. **Кластеризация маркеров** - улучшает производительность при большом количестве маркеров
4. **chunkedLoading** - загрузка маркеров порциями для лучшей производительности

## Особенности реализации

- Все компоненты являются функциональными и используют React Hooks
- Типизация через TypeScript для безопасности типов
- Разделение кода на переиспользуемые компоненты
- Использование Tailwind CSS для стилизации
- Настройка иконок Leaflet через CDN для корректного отображения
- Обработка состояния загрузки данных
- Обработка пустого состояния фильтрации

## Расширение функциональности

Для добавления новых возможностей:

1. **Добавление новых фильтров** - расширьте компонент `Filters.tsx`
2. **Добавление новых полей пользователя** - обновите интерфейс `User` в `types.ts`
3. **Изменение стилей** - используйте классы Tailwind CSS или добавьте кастомные стили в `index.css`
4. **Добавление новых маркеров** - расширьте компонент `UserMarker.tsx`
5. **Интеграция с реальным API** - замените загрузку из `users.json` на реальный API endpoint в `App.tsx`

## Лицензия

MIT
